<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<meta http-equiv=x-ua-compatible content="IE=edge, chrome=1">
<title>Get-LogonHistory: Who was logged on to my server? - Automate everything </title><meta name=Description content="Automate everything - Sebastian Gräf"><meta property="og:title" content="Get-LogonHistory: Who was logged on to my server?">
<meta property="og:description" content="Every System Administrator comes into a situation where you want to see who and how many users were logged on to your servers either via Remote Desktop or via script.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://graef.io/get-logonhistory-who-was-logged-on-to-my-server/"><meta property="og:image" content="https://graef.io/get-logonhistory-who-was-logged-on-to-my-server/featured-image-preview.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2017-10-05T11:26:46+08:00">
<meta property="article:modified_time" content="2017-10-05T11:26:46+08:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://graef.io/get-logonhistory-who-was-logged-on-to-my-server/featured-image-preview.png">
<meta name=twitter:title content="Get-LogonHistory: Who was logged on to my server?">
<meta name=twitter:description content="Every System Administrator comes into a situation where you want to see who and how many users were logged on to your servers either via Remote Desktop or via script.">
<meta name=application-name content="graef.io - Sebastian Gräf">
<meta name=apple-mobile-web-app-title content="graef.io - Sebastian Gräf"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://graef.io/get-logonhistory-who-was-logged-on-to-my-server/><link rel=prev href=https://graef.io/get-psversions-retrieve-powershell-version-remotely/><link rel=next href=https://graef.io/expired-azure-credentials/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><meta name=google-site-verification content="google-site-verification=081I19l1P1J3FFLaw1uKtAtY5KcJx_Z9ywiKt60VGP4"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Get-LogonHistory: Who was logged on to my server?","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/graef.io\/get-logonhistory-who-was-logged-on-to-my-server\/"},"image":["https:\/\/graef.io\/logo.png"],"genre":"posts","keywords":"Automation, scripts, PowerShell, posh, pwsh, Windows","wordcount":585,"url":"https:\/\/graef.io\/get-logonhistory-who-was-logged-on-to-my-server\/","datePublished":"2017-10-05T11:26:46+08:00","dateModified":"2017-10-05T11:26:46+08:00","publisher":{"@type":"Organization","name":"","logo":"https:\/\/graef.io\/logo.png"},"author":{"@type":"Person","name":"Sebastian Gräf"},"description":""}</script></head>
<body header-desktop=auto header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'light'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'light'==='dark')&&document.body.setAttribute('theme','dark')</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="Automate everything "><img class="lazyload logo" src=/svg/loading.min.svg data-src=/logo.png data-srcset="/logo.png, /logo.png 1.5x, /logo.png 2x" data-sizes=auto alt=/logo.png title=/logo.png></a>
</div>
<div class=menu>
<div class=menu-inner><a class=menu-item href=/posts/ title=Posts> Posts </a><a class=menu-item href=/categories/projects/ title=Projects> Projects </a><a class=menu-item href=/categories/til/ title="Today I learned"> TIL </a><a class=menu-item href=/tags/ title=Tags> Tags </a><a class=menu-item href=/categories/ title=Categories> Categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-desktop>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a>
</div>
</div>
</div>
</header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="Automate everything "><img class="lazyload logo" src=/svg/loading.min.svg data-src=/logo.png data-srcset="/logo.png, /logo.png 1.5x, /logo.png 2x" data-sizes=auto alt=/logo.png title=/logo.png></a>
</div>
<div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div>
</div>
<div class=menu id=menu-mobile><div class=search-wrapper>
<div class="search mobile" id=search-mobile>
<input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-mobile>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</div>
<a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>
Cancel
</a>
</div><a class=menu-item href=/posts/ title=Posts>Posts</a><a class=menu-item href=/categories/projects/ title=Projects>Projects</a><a class=menu-item href=/categories/til/ title="Today I learned">TIL</a><a class=menu-item href=/tags/ title=Tags>Tags</a><a class=menu-item href=/categories/ title=Categories>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a></div>
</div>
</header>
<div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div>
</div>
<div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div>
</div>
<main class=main>
<div class=container><article class="page single"><h1 class="single-title animated flipInX">Get-LogonHistory: Who was logged on to my server?</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=https://graef.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>Sebastian Gräf</a></span>&nbsp;<span class=post-category>included in <a href=/categories/scripts/><i class="far fa-folder fa-fw"></i>Scripts</a>&nbsp;<a href=/categories/powershell/><i class="far fa-folder fa-fw"></i>PowerShell</a>&nbsp;<a href=/categories/windows-server/><i class="far fa-folder fa-fw"></i>Windows Server</a></span></div>
<div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="Thursday, Oct 5, 2017">Thursday, Oct 5, 2017</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;585 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;3 minutes&nbsp;</div>
</div><div class=content id=content><p>Every System Administrator comes into a situation where you want to see who and how many users were logged on to your servers either via Remote Desktop or via script.</p>
<p>This little function evaluates the System log with the help of Get-EventLog and delivers you the latest logon and logoff events for every user.</p>
<p>I’ve left you the Invoke-Command commented if you want to use PowerShell Remoting (WinRM).</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=k>Function</span> <span class=nb>Get-LogonHistory</span>
<span class=p>{</span>
<span class=cm>&lt;#
</span><span class=cm></span><span class=sd>.SYNOPSIS</span><span class=cm>
</span><span class=cm>    Retrieves history of last logged on users with usernames and respective logoff/logon times.
</span><span class=cm>
</span><span class=cm></span><span class=sd>.DESCRIPTION</span><span class=cm>
</span><span class=cm>    Retrieves history of last logged on users with usernames and respective logoff/logon times.
</span><span class=cm>
</span><span class=cm></span><span class=sd>.PARAMETER</span><span class=cm> Newest
</span><span class=cm>    This command gets the most recent entries from the event log according to its value.
</span><span class=cm>
</span><span class=cm></span><span class=sd>.PARAMETER</span><span class=cm> ComputerName
</span><span class=cm>    A single Computer or an array of computer names. The default is localhost ($env:COMPUTERNAME).
</span><span class=cm>
</span><span class=cm></span><span class=sd>.PARAMETER</span><span class=cm> Credentials
</span><span class=cm>    Commit Credentials for a different domain.
</span><span class=cm>
</span><span class=cm></span><span class=sd>.PARAMETER</span><span class=cm> Verbose
</span><span class=cm>    Run in Verbose Mode.
</span><span class=cm>
</span><span class=cm></span><span class=sd>.EXAMPLE</span><span class=cm>
</span><span class=cm>    PS C:\&gt; Get-LogonHistory -ComputerName SERVER1 -Credentials Get-Credential -Newst
</span><span class=cm>
</span><span class=cm></span><span class=sd>.NOTES</span><span class=cm>
</span><span class=cm>    Author:  Sebastian Gräf
</span><span class=cm>    Email:   ps@graef.io
</span><span class=cm>    Date:    April 15, 2017
</span><span class=cm>    PSVer:   2.0/3.0/4.0/5.0
</span><span class=cm>#&gt;</span>

    <span class=p>[</span><span class=k>Cmdletbinding</span><span class=p>()]</span>
    <span class=k>Param</span> <span class=p>(</span>
        <span class=p>[</span><span class=k>Parameter</span><span class=p>(</span><span class=k>ValueFromPipelineByPropertyName</span> <span class=p>=</span> <span class=nv>$true</span><span class=p>,</span> <span class=k>ValueFromPipeline</span> <span class=p>=</span> <span class=nv>$true</span><span class=p>)]</span>
        <span class=no>[string[]]</span><span class=nv>$ComputerName</span> <span class=p>=</span> <span class=nv>$Env:COMPUTERNAME</span><span class=p>,</span>
        <span class=p>[</span><span class=k>Parameter</span><span class=p>(</span><span class=k>ValueFromPipelineByPropertyName</span> <span class=p>=</span> <span class=nv>$true</span><span class=p>,</span> <span class=k>ValueFromPipeline</span> <span class=p>=</span> <span class=nv>$true</span><span class=p>)]</span>
        <span class=no>[string]</span><span class=nv>$Newest</span> <span class=p>=</span> <span class=n>10</span><span class=p>,</span>
        <span class=p>[</span><span class=k>Parameter</span><span class=p>(</span><span class=k>ValueFromPipelineByPropertyName</span> <span class=p>=</span> <span class=nv>$true</span><span class=p>,</span> <span class=k>ValueFromPipeline</span> <span class=p>=</span> <span class=nv>$true</span><span class=p>)]</span>
        <span class=p>[</span><span class=n>ValidateNotNull</span><span class=p>()]</span>
        <span class=no>[System.Management.Automation.PSCredential]</span><span class=p>[</span><span class=n>System</span><span class=p>.</span><span class=n>Management</span><span class=p>.</span><span class=n>Automation</span><span class=p>.</span><span class=n>Credential</span><span class=p>()]</span>
        <span class=nv>$Credentials</span> <span class=p>=</span> <span class=no>[System.Management.Automation.PSCredential]</span><span class=p>::</span><span class=n>Empty</span>
    <span class=p>)</span>

    <span class=k>Begin</span>
    <span class=p>{</span>
        <span class=nb>Write-Verbose</span> <span class=s2>&#34; [</span><span class=p>$(</span><span class=nv>$MyInvocation</span><span class=p>.</span><span class=n>InvocationName</span><span class=p>)</span><span class=s2>] :: Start Process&#34;</span>
        <span class=nv>$Results</span> <span class=p>=</span> <span class=p>@()</span>
        <span class=nv>$ProgressCounter</span> <span class=p>=</span> <span class=n>0</span>
    <span class=p>}</span>


    <span class=k>Process</span>
    <span class=p>{</span>
        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$Computer</span> <span class=k>in</span> <span class=nv>$ComputerName</span><span class=p>)</span>
        <span class=p>{</span>
            <span class=nv>$ProgressCounter</span><span class=p>++</span>
            <span class=nb>Write-Progress</span> <span class=n>-activity</span> <span class=s2>&#34;Running on $Computer&#34;</span> <span class=n>-status</span> <span class=s2>&#34;Please wait ...&#34;</span> <span class=n>-PercentComplete</span> <span class=p>((</span><span class=nv>$ProgressCounter</span> <span class=p>/</span> <span class=nv>$ComputerName</span><span class=p>.</span><span class=n>length</span><span class=p>)</span> <span class=p>*</span> <span class=n>100</span><span class=p>)</span>
            <span class=k>if</span> <span class=p>(</span><span class=nb>Test-Connection</span> <span class=nv>$Computer</span> <span class=n>-Count</span> <span class=n>1</span> <span class=n>-Quiet</span><span class=p>)</span>
            <span class=p>{</span>
                <span class=nb>Write-Verbose</span> <span class=s2>&#34; [</span><span class=p>$(</span><span class=nv>$MyInvocation</span><span class=p>.</span><span class=n>InvocationName</span><span class=p>)</span><span class=s2>] :: Processing $Computer&#34;</span>
                <span class=k>try</span>
                <span class=p>{</span>
                    <span class=nv>$ELogs</span> <span class=p>=</span> <span class=nb>Get-EventLog</span> <span class=n>System</span> <span class=n>-Source</span> <span class=nb>Microsoft-Windows</span><span class=n>-WinLogon</span> <span class=n>-ComputerName</span> <span class=nv>$Computer</span> <span class=n>-Newest</span> <span class=nv>$Newest</span>
                    <span class=c>#$ELogs = Invoke-Command { param ($Newest) Get-EventLog System -Source Microsoft-Windows-WinLogon -Newest $Newest } -ArgumentList $Newest -ComputerName $Computer</span>
                    <span class=k>ForEach</span> <span class=p>(</span><span class=nv>$Log</span> <span class=k>in</span> <span class=nv>$ELogs</span><span class=p>)</span>
                    <span class=p>{</span>
                        <span class=k>If</span> <span class=p>(</span><span class=nv>$Log</span><span class=p>.</span><span class=n>InstanceId</span> <span class=o>-eq</span> <span class=n>7001</span><span class=p>)</span>
                        <span class=p>{</span>
                            <span class=nv>$EventType</span> <span class=p>=</span> <span class=s2>&#34;Logon&#34;</span>
                        <span class=p>}</span>
                        <span class=k>ElseIf</span> <span class=p>(</span><span class=nv>$Log</span><span class=p>.</span><span class=n>InstanceId</span> <span class=o>-eq</span> <span class=n>7002</span><span class=p>)</span>
                        <span class=p>{</span>
                            <span class=nv>$EventType</span> <span class=p>=</span> <span class=s2>&#34;Logoff&#34;</span>
                        <span class=p>}</span>
                        <span class=k>Else</span>
                        <span class=p>{</span>
                            <span class=k>Continue</span>
                        <span class=p>}</span>
                        <span class=nv>$Results</span> <span class=p>+=</span> <span class=nb>New-Object</span> <span class=n>PSObject</span> <span class=n>-Property</span> <span class=p>@{</span>
                            <span class=n>User</span> <span class=p>=</span> <span class=p>(</span><span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=n>Security</span><span class=p>.</span><span class=n>Principal</span><span class=p>.</span><span class=n>SecurityIdentifier</span> <span class=nv>$Log</span><span class=p>.</span><span class=n>ReplacementStrings</span><span class=p>[</span><span class=n>1</span><span class=p>]).</span><span class=n>Translate</span><span class=p>(</span><span class=no>[System.Security.Principal.NTAccount]</span><span class=p>)</span>
                            <span class=n>Time</span> <span class=p>=</span> <span class=nv>$Log</span><span class=p>.</span><span class=n>TimeWritten</span>
                            <span class=s1>&#39;Event Type&#39;</span> <span class=p>=</span> <span class=nv>$EventType</span>
                        <span class=p>}</span>
                    <span class=p>}</span>
                    <span class=nv>$Results</span>
                <span class=p>}</span>
                <span class=k>catch</span>
                <span class=p>{</span>
                    <span class=nb>Write-Verbose</span> <span class=s2>&#34; Host [$Computer] Failed with Error: </span><span class=p>$(</span><span class=nv>$Error</span><span class=p>[</span><span class=n>0</span><span class=p>])</span><span class=s2>&#34;</span>
                <span class=p>}</span>
            <span class=p>}</span>
            <span class=k>else</span>
            <span class=p>{</span>
                <span class=nb>Write-Verbose</span> <span class=s2>&#34; Host [$Computer] Failed Connectivity Test&#34;</span>
            <span class=p>}</span>
        <span class=p>}</span>
        <span class=nv>$result</span> <span class=p>|</span> <span class=nb>Select </span><span class=n>User</span><span class=p>,</span> <span class=n>Time</span><span class=p>,</span> <span class=s2>&#34;Event Type&#34;</span> <span class=p>|</span> <span class=nb>Sort </span><span class=n>Time</span> <span class=n>-Descending</span>
    <span class=p>}</span>
    <span class=k>End</span>
    <span class=p>{</span>
        <span class=nb>Write-Progress</span> <span class=n>-activity</span> <span class=s2>&#34;Running on $Computer&#34;</span> <span class=n>-Status</span> <span class=s2>&#34;Completed.&#34;</span> <span class=n>-Completed</span>
        <span class=nb>Write-Verbose</span> <span class=s2>&#34; [</span><span class=p>$(</span><span class=nv>$MyInvocation</span><span class=p>.</span><span class=n>InvocationName</span><span class=p>)</span><span class=s2>] :: End Process&#34;</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>Please keep in mind, it evaluates every event, this means even if a user was doing actions remotely using a powershell script or just logged on, it will be displayed as well. If you want to distinguish between script logons you can easily have a look at the logon and logoff times. If a user account was only logged for some seconds … then this is an indicator for a remote script logon.</p>
<p>The script will give you following output:</p>
<p>While using following command you can also query this function to more than just one server:</p>
<figure><a class=lightgallery href=featured-image-preview.png title=featured-image-preview.png data-thumbnail=featured-image-preview.png data-sub-html="<h2>.</h2>">
<img class=lazyload src=/svg/loading.min.svg data-src=featured-image-preview.png data-srcset="featured-image-preview.png, featured-image-preview.png 1.5x, featured-image-preview.png 2x" data-sizes=auto alt=featured-image-preview.png>
</a><figcaption class=image-caption>.</figcaption>
</figure>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=nb>Get-LogonHistory</span> <span class=n>-ComputerName</span> <span class=p>(</span><span class=nb>gc </span><span class=n>C:</span><span class=p>\</span><span class=n>computers</span><span class=p>.</span><span class=n>txt</span><span class=p>)</span> <span class=n>-Newest</span> <span class=n>30</span>
</code></pre></td></tr></table>
</div>
</div></div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on Thursday, Oct 5, 2017</span>
</div>
<div class=post-info-license></div>
</div>
<div class=post-info-line>
<div class=post-info-md></div>
<div class=post-info-share>
<span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://graef.io/get-logonhistory-who-was-logged-on-to-my-server/ data-title="Get-LogonHistory: Who was logged on to my server?" data-via=segraef data-hashtags=Automation,scripts,PowerShell,posh,pwsh,Windows><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://graef.io/get-logonhistory-who-was-logged-on-to-my-server/ data-hashtag=Automation><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://graef.io/get-logonhistory-who-was-logged-on-to-my-server/><i class="fab fa-linkedin fa-fw"></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://graef.io/get-logonhistory-who-was-logged-on-to-my-server/ data-title="Get-LogonHistory: Who was logged on to my server?" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://graef.io/get-logonhistory-who-was-logged-on-to-my-server/><i class="fab fa-reddit fa-fw"></i></a></span>
</div>
</div>
</div>
<div class=post-info-more>
<section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/automation/>automation</a>,&nbsp;<a href=/tags/scripts/>Scripts</a>,&nbsp;<a href=/tags/powershell/>PowerShell</a>,&nbsp;<a href=/tags/posh/>posh</a>,&nbsp;<a href=/tags/pwsh/>pwsh</a>,&nbsp;<a href=/tags/windows/>Windows</a></section>
<section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section>
</div>
<div class=post-nav><a href=/get-psversions-retrieve-powershell-version-remotely/ class=prev rel=prev title="Get-PSVersions: Retrieve Powershell version remotely"><i class="fas fa-angle-left fa-fw"></i>Get-PSVersions: Retrieve Powershell version remotely</a>
<a href=/expired-azure-credentials/ class=next rel=next title="Expired Azure credentials">Expired Azure credentials<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id=comments><div id=utterances></div><noscript>
Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.
</noscript></div></article></div>
</main><footer class=footer>
<div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2021 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://graef.io target=_blank>Sebastian Gräf</a></span></div>
</div>
</footer></div>
<div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw"></i>
</a>
</div><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:20},comment:{utterances:{darkTheme:"github-dark",issueTerm:"pathname",label:"",lightTheme:"github-light",repo:"segraef/graef.io"}},lightGallery:{actualSize:!1,exThumbImage:"data-thumbnail",hideBarsDelay:2e3,selector:".lightgallery",speed:400,thumbContHeight:80,thumbWidth:80,thumbnail:!0},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-99599711-2',{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-99599711-2" async></script></body>
</html>